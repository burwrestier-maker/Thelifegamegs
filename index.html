<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BPS Chronicles - Boss Rush Edition</title>
    <link rel="icon" href="97071.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { 
            --gold: #f1c40f; --bg: #0d0e18; --panel: #1c1f33; --border: #4a517a;
            --xp: #9b59b6;
        }

        * { box-sizing: border-box; font-family: 'Press Start 2P', cursive; touch-action: manipulation; user-select: none; }

        body { margin: 0; background: #000; color: #e0e0e0; overflow: hidden; width: 100vw; height: 100vh; }

        /* --- EST√âTICA DE BATALHA --- */
        .battle-stage {
            position: relative; width: 100%; height: 300px;
            display: flex; justify-content: space-around; align-items: center;
            perspective: 600px; margin-top: 20px;
        }

        .character-platform { display: flex; flex-direction: column; align-items: center; position: relative; }

        .base-oval {
            width: 150px; height: 40px; background: rgba(255, 255, 255, 0.2);
            border-radius: 50%; box-shadow: 0 10px 25px rgba(0,0,0,0.6);
            margin-top: -20px; border: 2px solid rgba(255,255,255,0.1);
        }

        .sprite {
            width: 130px; height: 130px; object-fit: contain;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.9));
            z-index: 2; image-rendering: pixelated;
            animation: idleFloat 3s ease-in-out infinite;
        }

        @keyframes idleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        /* ANIMA√á√ïES DE ATAQUE */
        .atk-p { animation: dashP 0.4s ease-in-out; }
        @keyframes dashP {
            0% { transform: translate(0, 0); }
            50% { transform: translate(70px, -30px) scale(1.1); }
            100% { transform: translate(0, 0); }
        }

        .atk-b { animation: dashB 0.4s ease-in-out; }
        @keyframes dashB {
            0% { transform: translate(0, 0); }
            50% { transform: translate(-70px, 30px) scale(1.1); }
            100% { transform: translate(0, 0); }
        }

        .take-dmg { animation: blink 0.15s 3; }
        @keyframes blink { 
            0%, 100% { opacity: 1; filter: brightness(1); } 
            50% { opacity: 0.5; filter: brightness(3) sepia(1) saturate(500%) hue-rotate(-50deg); } 
        }

        .shake-screen { animation: shake 0.3s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* --- INTERFACE --- */
        .ui-panel { background: var(--panel); border: 4px solid var(--border); padding: 20px; width: 95%; max-width: 800px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .screen { display: none; width: 100vw; height: 100vh; padding: 20px; flex-direction: column; align-items: center; justify-content: center; background-size: cover; background-position: center; transition: 0.8s; }
        .active { display: flex; }
        
        .stats-banner { background: rgba(0,0,0,0.8); border: 2px solid var(--gold); padding: 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 8px; }
        button { background: linear-gradient(#444, #111); color: var(--gold); border: 2px solid var(--gold); padding: 12px; cursor: pointer; font-size: 8px; text-transform: uppercase; }
        button:hover { background: var(--gold); color: #000; }
        button:active { transform: translateY(3px); }

        .bar-container { width: 100%; height: 12px; background: #222; border: 2px solid #fff; margin: 5px 0; overflow: hidden; }
        .bar-fill { height: 100%; transition: width 0.4s ease-in-out; }
        .battle-log { background: rgba(0,0,0,0.85); border: 2px solid var(--gold); height: 100px; width: 100%; overflow-y: auto; padding: 10px; font-size: 8px; color: #0f0; margin-top: 15px; }

        .item-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; max-height: 300px; overflow-y: auto; }
        .card { background: #0d0e18; border: 2px solid #444; padding: 10px; display: flex; align-items: center; justify-content: space-between; }
    </style>
</head>
<body id="game-body">

    <div id="scr-start" class="screen active" style="background: radial-gradient(#1c1f33, #000);">
        <div class="ui-panel" style="max-width: 450px; text-align: center;">
            <h1 style="color:var(--gold); font-size: 18px; margin-bottom: 20px;">BPS CHRONICLES</h1>
            <input type="text" id="auth-user" placeholder="USU√ÅRIO" style="width:100%; padding:15px; margin-bottom:10px; background:#000; color:var(--gold); border:2px solid var(--border);">
            <input type="password" id="auth-pass" placeholder="SENHA" style="width:100%; padding:15px; margin-bottom:10px; background:#000; color:var(--gold); border:2px solid var(--border);">
            <div id="reg-box" style="display:none;">
                <input type="text" id="p-name-input" placeholder="NOME DO HER√ìI" style="width:100%; padding:15px; margin-bottom:10px; background:#000; color:var(--gold); border:2px solid var(--border);">
                <select id="p-race-select" style="width:100%; padding:15px; margin-bottom:10px; background:#000; color:var(--gold); border:2px solid var(--border);">
                    <option value="Mago">MAGO</option>
                    <option value="Humano">HUMANO</option>
                    <option value="Maldi√ß√£o">MALDI√á√ÉO</option>
                </select>
            </div>
            <button onclick="handleAuth()" id="auth-btn" style="width:100%; padding:15px;">ENTRAR NO REINO</button>
            <p onclick="toggleReg()" style="font-size:8px; cursor:pointer; margin-top:15px; color:#aaa;">Novo aqui? Criar uma conta</p>
        </div>
    </div>

    <div id="scr-hub" class="screen" style="background-image: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('97057.jpg');">
        <div class="ui-panel">
            <h2 id="hub-name" style="color:var(--gold); font-size:14px; margin-bottom:15px;">HER√ìI</h2>
            <div class="stats-banner">
                <div>‚ù§Ô∏è VIDA: <span id="st-hp">100</span></div>
                <div>üíß MANA: <span id="st-mana">50</span></div>
                <div>‚öîÔ∏è FOR√áA: <span id="st-str">10</span></div>
                <div>üí∞ BPS: <span id="hub-coins">0</span></div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:20px;">
                <button onclick="changeScreen('scr-battle')" style="grid-column: span 2; background:#5e1919; font-size:10px;">‚öîÔ∏è ENFRENTAR BOSS</button>
                <button onclick="changeScreen('scr-habits')">üèãÔ∏è MISS√ïES</button>
                <button onclick="changeScreen('scr-stats')">üë§ UPGRADE</button>
                <button onclick="changeScreen('scr-shop')">üõí LOJA</button>
                <button onclick="changeScreen('scr-inv')">üéí MOCHILA</button>
            </div>
        </div>
    </div>

    <div id="scr-battle" class="screen">
        <div class="battle-stage">
            <div class="character-platform">
                <img id="bt-img-p" src="" class="sprite">
                <div class="base-oval"></div>
                <div style="width: 130px; margin-top: 15px;">
                    <div class="bar-container"><div id="bt-hp-p" class="bar-fill" style="background:#2ecc71; width:100%;"></div></div>
                    <div class="bar-container" style="height:6px;"><div id="bt-mn-p" class="bar-fill" style="background:#3498db; width:100%;"></div></div>
                </div>
            </div>
            <div class="character-platform">
                <img id="bt-img-b" src="" class="sprite">
                <div class="base-oval"></div>
                <div style="width: 130px; margin-top: 15px;">
                    <div class="bar-container"><div id="bt-hp-b" class="bar-fill" style="background:#e74c3c; width:100%;"></div></div>
                    <p id="bt-name-b" style="font-size:8px; text-align:center; color:#ff4d4d; text-shadow: 2px 2px #000;">BOSS</p>
                </div>
            </div>
        </div>
        <div id="battle-log" class="battle-log"></div>
        <div id="battle-btns" style="display:flex; gap:10px; margin-top:20px;"></div>
    </div>

    <div id="scr-habits" class="screen" style="background:#000;"><div class="ui-panel"><button onclick="changeScreen('scr-hub')">< VOLTAR</button><h3>MISS√ïES</h3><button onclick="addPoints(10)" style="width:100%; margin-top:20px;">üèÉ CONCLUIR TAREFA (+10 PTS)</button></div></div>
    <div id="scr-stats" class="screen" style="background:#000;"><div class="ui-panel"><button onclick="changeScreen('scr-hub')">< VOLTAR</button><h3>PONTOS: <span id="train-pts">0</span></h3><button onclick="upgrade('str')" style="width:100%; margin-bottom:10px;">+ FOR√áA</button><button onclick="upgrade('hp')" style="width:100%;">+ VIDA</button></div></div>
    <div id="scr-shop" class="screen" style="background:#000;"><div class="ui-panel"><button onclick="changeScreen('scr-hub')">< VOLTAR</button><h3>LOJA DE HER√ìIS</h3><div id="shop-list" class="item-grid"></div></div></div>
    <div id="scr-inv" class="screen" style="background:#000;"><div class="ui-panel"><button onclick="changeScreen('scr-hub')">< VOLTAR</button><h3>MOCHILA</h3><div id="inv-list" class="item-grid"></div></div></div>

    <script>
        // --- CONFIGURA√á√ÉO DOS 8 CHEF√ïES ---
        const BOSSES = [
            { n: "Elemental de Barro", img: "boss_1.jpg", hp: 150, atk: 20, rew: 100, bg: "cenario_1.jpg" },
            { n: "Guardi√£o da Floresta", img: "boss_2.jpg", hp: 500, atk: 45, rew: 300, bg: "cenario_2.jpg" },
            { n: "N√©bula do Deserto", img: "boss_3.jpg", hp: 1200, atk: 80, rew: 700, bg: "cenario_3.jpg" },
            { n: "Golem de Ferro", img: "boss_4.jpg", hp: 2500, atk: 130, rew: 1200, bg: "cenario_4.jpg" },
            { n: "Lorde das Sombras", img: "boss_5.jpg", hp: 4500, atk: 200, rew: 2000, bg: "cenario_5.jpg" },
            { n: "Drag√£o Vermelho", img: "boss_6.jpg", hp: 7000, atk: 300, rew: 4000, bg: "cenario_6.jpg" },
            { n: "Rei Maldi√ß√£o", img: "boss_7.jpg", hp: 12000, atk: 450, rew: 8000, bg: "cenario_7.jpg" },
            { n: "Olho Abissal (FINAL)", img: "boss_8.jpg", hp: 25000, atk: 700, rew: 50000, bg: "cenario_8.jpg" }
        ];

        const HEROES = [
            { id: 'h1', n: 'Alaric, o Disposto', p: 1000, img: 'hum_alaric.jpg', bonus: { str: 20, hp: 200 } },
            { id: 'h2', n: 'Arkan, o Mestre', p: 2500, img: 'mago_arkan.jpg', bonus: { str: 50, hp: 500 } },
            { id: 'h3', n: 'V√≥rtex Supremo', p: 10000, img: 'mal_vortex.jpg', bonus: { str: 200, hp: 2000 } }
        ];

        let p = {}, currentAccount = null, isReg = false, bt = { active: false };

        // --- SISTEMA DE LOGIN ---
        function toggleReg() { isReg = !isReg; document.getElementById('reg-box').style.display = isReg ? 'block' : 'none'; }
        
        function handleAuth() {
            const user = document.getElementById('auth-user').value;
            let accounts = JSON.parse(localStorage.getItem("bps_accounts")) || [];
            if(isReg) {
                p = { name: document.getElementById('p-name-input').value, coins: 100, pts: 0, str: 15, manaM: 60, hpM: 120, inv: [], bossIdx: 0, img: '97074.jpg', bonusStr:0, bonusHp:0 };
                accounts.push({ user, pass: document.getElementById('auth-pass').value, saveData: p });
                localStorage.setItem("bps_accounts", JSON.stringify(accounts));
            } else {
                const acc = accounts.find(a => a.user === user);
                if(acc) p = acc.saveData; else return alert("Dados incorretos!");
            }
            currentAccount = user; changeScreen('scr-hub');
        }

        function save() {
            let accounts = JSON.parse(localStorage.getItem("bps_accounts")) || [];
            const idx = accounts.findIndex(a => a.user === currentAccount);
            if(idx !== -1) { accounts[idx].saveData = p; localStorage.setItem("bps_accounts", JSON.stringify(accounts)); }
        }

        // --- NAVEGA√á√ÉO ---
        function changeScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 'scr-shop') renderShop();
            if(id === 'scr-inv') renderInv();
            if(id === 'scr-battle') startBattle();
            updateUI();
        }

        function updateUI() {
            document.getElementById("hub-name").textContent = p.name.toUpperCase();
            document.getElementById("st-hp").textContent = p.hpM + p.bonusHp;
            document.getElementById("st-str").textContent = p.str + p.bonusStr;
            document.getElementById("hub-coins").textContent = p.coins;
            document.getElementById("train-pts").textContent = p.pts;
            save();
        }

        function addPoints(v) { p.pts += v; updateUI(); }
        function upgrade(s) { if(p.pts > 0) { if(s==='str') p.str += 5; else p.hpM += 20; p.pts--; updateUI(); } }

        // --- LOJA ---
        function renderShop() {
            const list = document.getElementById("shop-list"); list.innerHTML = "";
            HEROES.forEach(h => {
                const owned = p.inv.some(i => i.id === h.id);
                list.innerHTML += `<div class="card"><span>${h.n}</span><button onclick="buyHero('${h.id}')" ${owned?'disabled':''}>${owned?'OK':h.p+' bps'}</button></div>`;
            });
        }

        function buyHero(id) {
            const h = HEROES.find(i => i.id === id);
            if(p.coins >= h.p) { p.coins -= h.p; p.inv.push(h); renderShop(); updateUI(); }
        }

        function renderInv() {
            const list = document.getElementById("inv-list"); list.innerHTML = "";
            p.inv.forEach((it, idx) => {
                list.innerHTML += `<div class="card"><span>${it.n}</span><button onclick="equip(${idx})">EQUIPAR</button></div>`;
            });
        }

        function equip(idx) {
            const it = p.inv[idx];
            p.img = it.img; p.bonusStr = it.bonus.str; p.bonusHp = it.bonus.hp;
            alert(it.n + " equipado!"); updateUI();
        }

        // --- SISTEMA DE BATALHA ---
        function startBattle() {
            if(p.bossIdx >= BOSSES.length) { alert("TODOS OS BOSSES FORAM DERROTADOS!"); return changeScreen('scr-hub'); }
            const boss = BOSSES[p.bossIdx];
            
            // TROCA O CEN√ÅRIO DE FUNDO
            document.getElementById("scr-battle").style.backgroundImage = `linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('${boss.bg}')`;

            bt = { 
                active: true, 
                pHP: p.hpM + p.bonusHp, pMaxHP: p.hpM + p.bonusHp,
                bHP: boss.hp, bMaxHP: boss.hp,
                atkP: p.str + p.bonusStr
            };

            document.getElementById("bt-img-p").src = p.img;
            document.getElementById("bt-img-b").src = boss.img;
            document.getElementById("bt-name-b").textContent = boss.n;
            document.getElementById("battle-btns").innerHTML = `<button onclick="atkP()" style="padding:15px; width:150px;">ATACAR</button>`;
            refreshBars();
            log(`Voc√™ encontrou ${boss.n}!`, '#fff');
        }

        function atkP() {
            if(!bt.active) return;
            const spr = document.getElementById("bt-img-p");
            spr.classList.add('atk-p');
            setTimeout(() => spr.classList.remove('atk-p'), 400);

            let dmg = Math.floor(bt.atkP * (0.9 + Math.random()*0.2));
            bt.bHP -= dmg;
            
            const bSpr = document.getElementById("bt-img-b");
            setTimeout(() => {
                bSpr.classList.add('take-dmg');
                log(`Dano causado: ${dmg}`, '#0f0');
                refreshBars();
                if(bt.bHP <= 0) win(); else setTimeout(bossT, 600);
                setTimeout(() => bSpr.classList.remove('take-dmg'), 500);
            }, 200);
        }

        function bossT() {
            if(!bt.active) return;
            const spr = document.getElementById("bt-img-b");
            spr.classList.add('atk-b');
            setTimeout(() => spr.classList.remove('atk-b'), 400);

            const b = BOSSES[p.bossIdx];
            let dmg = Math.floor(b.atk * (0.8 + Math.random()*0.4));
            
            setTimeout(() => {
                document.getElementById("game-body").classList.add('shake-screen');
                document.getElementById("bt-img-p").classList.add('take-dmg');
                bt.pHP -= dmg;
                log(`${b.n} atacou: ${dmg}`, 'red');
                refreshBars();
                if(bt.pHP <= 0) { alert("Voc√™ foi derrotado!"); changeScreen('scr-hub'); }
                setTimeout(() => {
                    document.getElementById("game-body").classList.remove('shake-screen');
                    document.getElementById("bt-img-p").classList.remove('take-dmg');
                }, 400);
            }, 200);
        }

        function win() {
            bt.active = false;
            const b = BOSSES[p.bossIdx]; p.coins += b.rew; p.bossIdx++;
            alert(`VIT√ìRIA! Voc√™ derrotou ${b.n} e ganhou ${b.rew} bps!`);
            changeScreen('scr-hub');
        }

        function log(m, c) { const l = document.getElementById("battle-log"); l.innerHTML = `<div style="color:${c}">> ${m}</div>` + l.innerHTML; }
        function refreshBars() {
            document.getElementById("bt-hp-p").style.width = Math.max(0, (bt.pHP/bt.pMaxHP*100))+"%";
            document.getElementById("bt-hp-b").style.width = Math.max(0, (bt.bHP/bt.bMaxHP*100))+"%";
        }
    </script>
</body>
</html>